<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Human Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===============================
   CORE STYLE
================================ */
* {
    box-sizing: border-box;
    user-select: none;
}

body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: #f2f2f2;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: background 0.6s;
}

body.dark {
    background: #000;
}

.app {
    width: 360px;
    background: #fff;
    padding: 24px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 0 30px rgba(0,0,0,0.25);
    position: relative;
}

body.dark .app {
    background: #111;
    color: #eee;
}

h2 {
    margin: 0 0 10px;
}

.message {
    min-height: 24px;
    margin: 10px 0;
    color: #666;
}

.grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    margin: 20px 0;
}

.tile {
    height: 70px;
    background: #ccc;
    border-radius: 6px;
    cursor: pointer;
    transition: 0.15s;
}

.tile:hover {
    transform: scale(1.05);
}

.controls {
    display: flex;
    gap: 10px;
    justify-content: center;
}

button {
    padding: 8px 14px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

#easy {
    background: #2196f3;
    color: white;
}

#reset {
    background: #4caf50;
    color: white;
}

/* Flashlight */
.flash {
    position: fixed;
    inset: 0;
    pointer-events: none;
    opacity: 0;
    background: radial-gradient(
        circle 120px at 0 0,
        transparent 0%,
        rgba(0,0,0,0.95) 90%
    );
    transition: opacity 0.4s;
}

/* Falling button */
@keyframes fall {
    to {
        transform: translateY(200px) rotate(40deg);
        opacity: 0;
    }
}

.fall {
    animation: fall 1.2s forwards;
}

/* Rage text */
.bwahaha {
    color: red;
    margin-top: 10px;
    animation: pulse 1s infinite;
}

@keyframes pulse {
    50% { opacity: 0.4; }
}

/* End screen */
.end {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    color: white;
    display: none;
    justify-content: center;
    align-items: center;
    text-align: center;
}
</style>
</head>

<body>

<div class="app">
    <h2>Human Verification</h2>
    <div class="message" id="msg">Find the odd one.</div>

    <div class="grid" id="grid"></div>

    <div class="controls">
        <button id="easy">Easy</button>
        <button id="reset">Reset</button>
    </div>
</div>

<div class="flash" id="flash"></div>
<div class="end" id="end"></div>

<script>
/* ===============================
   RAGE ENGINE
================================ */

let correct = 0;
let rage = 0;
let dark = false;
let clicks = 0;

const grid = document.getElementById("grid");
const msg = document.getElementById("msg");
const flash = document.getElementById("flash");
const end = document.getElementById("end");

/* -----------------------------
   BUILD GRID
------------------------------ */
function build() {
    grid.innerHTML = "";
    const base = rand(120,170);
    correct = rand(0,15);

    for (let i = 0; i < 16; i++) {
        const t = document.createElement("div");
        t.className = "tile";
        t.style.background =
            i === correct
            ? `rgb(${base+3},${base+3},${base+3})`
            : `rgb(${base},${base},${base})`;

        t.onclick = () => click(i);
        grid.appendChild(t);
    }
}

/* -----------------------------
   CLICK LOGIC
------------------------------ */
function click(i) {
    rage++;
    clicks++;

    if (Math.random() < 0.8) {
        msg.textContent = pick([
            "Wrong.",
            "No.",
            "Not that.",
            "You hesitated.",
            "Almost.",
            "Try again."
        ]);
    } else {
        msg.textContent = "Correct.";
    }

    if (rage > 6) msg.textContent = "You're trying too hard.";
    if (rage > 10) msg.textContent = "Stop overthinking.";
    if (rage > 14) endGame();

    build();
}

/* -----------------------------
   EASY BUTTON = LIE
------------------------------ */
document.getElementById("easy").onclick = () => {
    if (dark) return;

    dark = true;
    document.body.classList.add("dark");
    flash.style.opacity = 1;

    const btn = document.getElementById("easy");
    btn.classList.add("fall");

    setTimeout(() => {
        btn.style.display = "none";
        const t = document.createElement("div");
        t.className = "bwahaha";
        t.textContent = "You believed that.";
        document.querySelector(".controls").appendChild(t);
    }, 1200);
};

/* -----------------------------
   FLASHLIGHT FOLLOW
------------------------------ */
document.addEventListener("mousemove", e => {
    if (!dark) return;
    flash.style.background = `
        radial-gradient(
            circle 120px at ${e.clientX}px ${e.clientY}px,
            transparent 0%,
            rgba(0,0,0,0.95) 90%
        )
    `;
});

/* -----------------------------
   END
------------------------------ */
function endGame() {
    end.style.display = "flex";
    end.innerHTML = `
        <div>
            <h1>Enough.</h1>
            <p>This isn't about winning.</p>
            <p>Close the tab.</p>
        </div>
    `;
}

/* -----------------------------
   UTILS
------------------------------ */
function rand(a,b){ return Math.floor(Math.random()*(b-a))+a; }
function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

build();
</script>

</body>
</html>
